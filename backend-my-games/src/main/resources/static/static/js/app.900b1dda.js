(function(){"use strict";var t={9393:function(t,e,a){var s=a(2083),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{attrs:{id:"app_content"}},[a("router-view")],1)])},r=[],n={methods:{rejectPhone(){var t=navigator.userAgent,e=t.match(/(iPad).*OS\s([\d_]+)/),a=!e&&t.match(/(iPhone\sOS)\s([\d_]+)/),s=t.match(/(Android)\s+([\d.]+)/);(a||s)&&this.$router.replace({name:"error",params:{errorMsg:"使用iPad或者电脑来访问"}})}},beforeCreate(){this.$axios.interceptors.request.use((t=>(null!=localStorage.token&&""!==localStorage.token&&(t.headers.common["Login-Token"]=localStorage.token),t)),(t=>Promise.reject(t))),this.$axios.interceptors.response.use((t=>(412===t.data.code?(this.$store.state.token="",localStorage.removeItem("token"),localStorage.removeItem("username"),this.$router.replace({name:"login",params:{notice:!0}})):500===t.data.code&&this.$message.error(this.$store.state.serverErrMsg),t)),(t=>Promise.reject(t.response)))},mounted(){this.rejectPhone()}},o=n,l=a(3736),c=(0,l.Z)(o,i,r,!1,null,null,null),h=c.exports,d=a(3625),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",[a("h1",[t._v("玩点游戏吧")]),a("p",{attrs:{id:"home_content_comment1"}},[t._v("虽然界面有一点丑，所以wjn真帅")]),a("ul",{attrs:{id:"game_menu"}},t._l(t.games,(function(e,s){return a("router-link",{key:s,attrs:{to:e.to,tag:"span"}},[a("el-popover",{attrs:{content:e.description,placement:"right",title:"游戏说明",trigger:"hover",width:"200"}},[a("el-button",{staticStyle:{"margin-top":"10px",width:"250px","font-size":"20px"},attrs:{slot:"reference",type:"success"},slot:"reference"},[t._v(t._s(e.name)+" ")])],1),a("br")],1)})),1),t.isLogined?a("el-row",[a("span",{staticStyle:{"font-size":"15px","margin-right":"10px"}},[t._v("你好，"+t._s(t.username))]),a("el-button",{staticStyle:{"font-size":"15px"},attrs:{type:"text"},on:{click:t.logout}},[t._v("退出登录 ")])],1):a("el-row",[a("span",{staticStyle:{"font-size":"15px","margin-right":"10px"}},[t._v("你还没有登录")]),a("el-button",{staticStyle:{"font-size":"15px"},attrs:{type:"text"},on:{click:t.toLogin}},[t._v("点我去登录 ")])],1)],1)])},p=[],g={data(){return{games:[{name:"猜单双",to:"/game/odd_even",description:"2人游戏。鱿鱼游戏里的猜单双规则"},{name:"五子棋",to:"/game/gobang",description:"2人游戏。这还用解释？"},{name:"414",to:"/game/p414",description:"4人游戏。414玩法"},{name:"聊天室",to:"/game/chat_room",description:"这不是游戏。"}],isLogined:!1}},computed:{username(){return localStorage.username}},methods:{logout(){localStorage.removeItem("token"),localStorage.removeItem("username"),this.isLogined=!1},toLogin(){this.$router.push("/login")}},mounted(){this.$route.params.notice&&this.$message({type:"success",message:"登录成功！"}),this.isLogined=!(""===localStorage.token||null==localStorage.token)}},u=g,v=(0,l.Z)(u,m,p,!1,null,"41128e12",null),f=v.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",[a("el-main",[a("div",{attrs:{id:"login"}},[a("h1",{},[t._v("小pè游戏")]),a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doLogin.apply(null,arguments)}}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.logining,expression:"logining"}],attrs:{disabled:t.logining,type:"primary"},on:{click:t.doLogin}},[t._v("登录 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"text"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("注册账号 ")])],1)],1)],1)])],1),a("el-dialog",{attrs:{visible:t.dialogFormVisible,title:"注册账号",width:"500px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"form1",staticStyle:{"margin-left":"20%","margin-right":"20%"},attrs:{model:t.form1,rules:t.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:t.form1.username,callback:function(e){t.$set(t.form1,"username",e)},expression:"form1.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":""},model:{value:t.form1.password,callback:function(e){t.$set(t.form1,"password",e)},expression:"form1.password"}})],1),a("el-form-item",{attrs:{label:"验证码",prop:"password"}},[a("div",{staticStyle:{width:"100%",display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{width:"calc(100% - 120px)","margin-right":"20px"},attrs:{"show-password":""},model:{value:t.form1.code,callback:function(e){t.$set(t.form1,"code",e)},expression:"form1.code"}}),a("el-image",{staticStyle:{width:"100px",height:"40px",cursor:"pointer"},attrs:{src:t.codeUrl},on:{click:t.updateCode}})],1)]),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.registering,expression:"registering"}],attrs:{disabled:t.registering,type:"primary"},on:{click:t.doRegister}},[t._v("注册 ")])],1)],1)],1)],1)},_=[],y=(a(2556),{data:function(){return{form:{username:"",password:""},form1:{username:"",password:"",code:""},codeUrl:this.$store.state.backURL+"/kaptcha?d="+new Date,dialogFormVisible:!1,logining:!1,registering:!1,rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"密码最少6位",trigger:"blur"}]}}},beforeCreate(){localStorage.token&&this.$router.push("/home")},mounted(){this.$route.params.notice&&this.$message({type:"info",message:"现在还没登录，先登录吧。"})},computed:{},methods:{doLogin(){this.$refs["form"].validate((t=>{if(t){if(this.logining=!0,localStorage.token)return void this.$router.push({name:"Home"});this.$axios.post(this.$store.state.backURL+"/api/v1/login",{username:this.form.username,password:this.form.password}).then((t=>{console.log(t),void 0!==t.headers["authorization"]?(localStorage.setItem("token",t.headers["authorization"]),localStorage.setItem("username",this.form.username),this.$router.push("/home")):410===t.data.code?this.$message.error("用户不存在。"):this.$message.error("密码错误。"),this.logining=!1})).catch((t=>{this.$message.error(this.$store.state.serverErrMsg),console.log(t.msg),this.logining=!1}))}}))},doRegister(){this.registering=!0,this.$refs["form1"].validate((t=>{t?this.$axios.post(this.$store.state.backURL+"/api/v1/register",{username:this.form1.username,password:this.form1.password,code:this.form1.code}).then((t=>{200===t.data.code?(this.$message({type:"success",message:"注册成功"}),this.dialogFormVisible=!1):413===t.data.code?this.$message.error("参数不正确，注册失败。"):414===t.data.code?this.$message.error("用户名已存在。"):this.$message.error(this.$store.state.serverErrMsg),this.registering=!1})).catch((t=>{console.log(t),this.$message.error(this.$store.state.serverErrMsg),this.registering=!1})):this.registering=!1}))},updateCode(){this.codeUrl=this.$store.state.backURL+"/kaptcha?d="+new Date}}}),w=y,k=(0,l.Z)(w,b,_,!1,null,"0c35bc25",null),x=k.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"game"},[a("div",{attrs:{id:"game_header"}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{plain:"",type:"success"},on:{click:t.returnHome}},[a("i",{staticClass:"el-icon-back"}),t._v(" 返回 ")]),a("span",{staticStyle:{"margin-left":"20px","font-size":"20px"}},[t._v(t._s(this.$store.state.currentGameTitle))])],1),a("router-view",{attrs:{id:"router_view"}})],1)},S=[],D={methods:{returnHome(){this.$router.push("/")}}},C=D,O=(0,l.Z)(C,$,S,!1,null,"0fed0191",null),W=O.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"odd_even",style:t.oddEvenStyle},[a("PregameComponent",{ref:"pregame"}),t.gameData.roleFlag>-1?a("div",{attrs:{id:"game_body"}},[a("h1",[t._v("对手："),a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.gameData.opponent))])]),1===t.state?a("div",[0===t.gameData.roleFlag?a("div",[a("h1",[t._v("第"+t._s(t.gameData.round)+"回合你来出题")]),a("p",[t._v("准备好被对手猜的弹珠。")])]):t._e(),1===t.gameData.roleFlag?a("div",[a("h1",[t._v("第"+t._s(t.gameData.round)+"回合你来猜")]),a("p",[t._v("准备好押注的弹珠。")])]):t._e(),a("div",[a("el-row",{staticStyle:{width:"600px"}},[a("el-col",{attrs:{span:12}},[a("h3",[t._v("剩余的弹珠")]),a("div",[a("transition-group",{staticClass:"ball_container",attrs:{appear:"","enter-active-class":"animate__animated animate__bounceInDown","leave-active-class":"animate__animated animate__backOutUp"}},t._l(t.unusedChips,(function(e){return a("el-button",{key:e,staticStyle:{width:"45px",height:"45px",margin:"10px"},attrs:{circle:"",icon:"el-icon-plus",type:"primary"},on:{click:function(a){return t.useOneChip(e)}}})})),1)],1)]),a("el-col",{attrs:{span:12}},[0===t.gameData.roleFlag?a("h3",[t._v("用于出题的弹珠")]):a("h3",[t._v("用于押注的弹珠")]),a("div",[a("transition-group",{staticClass:"ball_container",attrs:{appear:"","enter-active-class":"animate__animated animate__bounceInDown","leave-active-class":"animate__animated animate__backOutUp"}},t._l(t.usedChips,(function(e){return a("el-button",{key:e,staticStyle:{width:"45px",height:"45px",margin:"10px"},attrs:{circle:"",icon:"el-icon-check",type:"success"},on:{click:function(a){return t.resetOneChip(e)}}})})),1)],1)])],1),1===t.gameData.roleFlag?a("el-row",[a("h3",[t._v("我猜对手是：")]),a("el-button",{attrs:{circle:"",type:"primary"},on:{click:t.changeOddOrEven}},[t._v(t._s(t.oddOrEvenStr))])],1):t._e(),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{disabled:t.isBtnDisabled,type:"success"},on:{click:t.sendData}},[t._v("我想好了 ")])],1)]):2===t.state?a("div",[a("h1",[t._v("请等待对手操作。")])]):3===t.state?a("div",[a("h1",[0===t.gameData.roleFlag&&t.gameData.deltaChip<0?a("span",{},[a("span",{staticStyle:{color:"#F56C6C"}},[t._v("你猜错了！")])]):0===t.gameData.roleFlag&&t.gameData.deltaChip>0?a("span",{},[a("span",{staticStyle:{color:"#67C23A"}},[t._v("你猜对了！")])]):1===t.gameData.roleFlag&&t.gameData.deltaChip>0?a("span",{},[a("span",{staticStyle:{color:"#67C23A"}},[t._v("对手猜错了")])]):a("span",[a("span",{staticStyle:{color:"#F56C6C"}},[t._v("对手猜对了！")])])]),1===t.gameData.roleFlag?a("p",[t._v(" 你出了"+t._s(t.gameData.prevUsed)+"，对手猜了"+t._s(t.getOpponentGuess())+"，押注了"+t._s(t.gameData.prevOpponentUsedChip)+" ")]):a("p",[t._v(" 对手出了"+t._s(t.gameData.prevOpponentUsedChip)+"，你猜了"+t._s(t.oddOrEvenStr)+"，押注了"+t._s(Math.abs(t.gameData.deltaChip))+" ")]),a("h2",{},[t._v("弹珠"),t.gameData.deltaChip>0?a("span",[t._v("+")]):t._e(),a("span",[t._v(t._s(t.gameData.deltaChip))])]),a("el-button",{attrs:{type:"success"},on:{click:t.nextRound}},[t._v("继续")])],1):4===t.state?a("div",[a("h1",[t._v("游戏结束")]),a("h1",[t.gameData.chip<=0?a("span",{staticStyle:{color:"#F56C6C"}},[t._v("你输了")]):t._e(),t.gameData.chip>0?a("span",{staticStyle:{color:"#67C23A"}},[t._v("你赢了")]):t._e()])]):t._e()]):t._e()],1)},j=[],F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.state<6&&-1!==t.state?a("div",{attrs:{id:"pregame_container"}},[1===t.state?a("div",[a("h1",[t._v("你想？")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.changeState(2)}}},[t._v("创建房间")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.changeState(4)}}},[t._v("加入房间")])],1):2===t.state?a("div",[a("h1",[t._v("起个房间名")]),a("el-row",{attrs:{align:"center",type:"flex"}},[a("el-input",{staticClass:"input",attrs:{maxlength:"20",type:"text"},model:{value:t.room,callback:function(e){t.room=e},expression:"room"}}),a("el-button",{attrs:{disabled:t.isBtnDisabled,loading:t.btnLoading,type:"success"},on:{click:function(e){return t.changeState(3)}}},[t._v(" 创建 ")])],1)],1):3===t.state?a("div",[a("h1",{},[t._v("正在等待玩家加入"+t._s(t.room)),a("span",{attrs:{id:"left_time"}},[t._v(t._s(t.leftTime))])]),a("span",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"waiting_circle"}}),a("span",{attrs:{id:"players_num"}},[t._v(t._s(t.$parent.playerNum)+"/"+t._s(t.$parent.totalPlayerNum))])]):4===t.state?a("div",[a("h1",[t._v("加入房间")]),a("el-row",{attrs:{align:"center",type:"flex"}},[a("el-input",{staticClass:"input",attrs:{maxlength:"20",type:"text"},model:{value:t.room,callback:function(e){t.room=e},expression:"room"}}),a("el-button",{attrs:{disabled:t.isBtnDisabled,loading:t.btnLoading,type:"success"},on:{click:function(e){return t.changeState(5)}}},[t._v(" 加入 ")])],1)],1):5===t.state?a("div",[a("h1",[t._v("游戏准备中...")]),a("div",{attrs:{id:"connecting_circle_container"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"connecting_circle"}})])]):t._e()]):t._e()},L=[],U={data(){return{state:1,room:"",leftTime:120,loading:!1,btnLoading:!1}},methods:{changeState(t){2===t||4===t?this.state=t:3===t?(this.btnLoading=!0,this.$axios.get(this.$store.state.backURL+"/game/"+this.$parent.gameUrl+"/create_room?room="+this.room).then((t=>{if(200===t.data.code){this.$message({type:"success",message:"房间创建成功了！"});let t=setInterval((()=>{this.leftTime>0&&(this.leftTime--,0===this.leftTime&&clearInterval(t))}),1e3);this.state=3,this.btnLoading=!1,this.loading=!0,this.$parent.waitPlayer()}else 420===t.data.code&&(this.$message.error(t.data.msg),this.btnLoading=!1)}))):5===t?(this.btnLoading=!0,this.$parent.enterRoom()):this.$message.error("错误的参数。")},startGame(){this.state=5,this.loading=!0,this.$parent.gaming()},enterDuoRoom(){this.$axios.get(this.$store.state.backURL+"/game/"+this.$parent.gameUrl+"/enter_room?room="+this.room).then((t=>{200===t.data.code?(this.$message({type:"success",message:"加入房间成功！开始游戏。"}),this.startGame(),this.$parent.gameData.opponent=t.data.opponent):(this.$message.error(t.data.msg),this.btnLoading=!1)}))},waitDuoPlayer(){this.$axios.get(this.$store.state.backURL+"/game/"+this.$parent.gameUrl+"/wait_player").then((t=>{200===t.data.code?(this.loading=!1,this.playerNum=2,this.$message({type:"success",message:"人数够了，开始游戏。"}),this.startGame()):421===t.data.code?(this.$message.error("等待玩家超时。"),this.state=1):320===t.data.code||this.$message.error(t.data.msg)}))}},computed:{isBtnDisabled(){return""===this.room||null==this.room}}},P=U,M=(0,l.Z)(P,F,L,!1,null,"6d0e9f4a",null),R=M.exports,T={components:{PregameComponent:R},data(){return{gameUrl:"odd_even",wsObj:null,state:0,usedChips:[],unusedChips:[],gameData:{round:0,roleFlag:-1,chip:0,usedChip:0,opponent:"",oddOrEven:0,deltaChip:0,gameOver:!1,prevOpponentUsedChip:0,prevUsed:0},playerNum:1,totalPlayerNum:2}},methods:{arrayElemIdx(t,e){for(let a=0;a<t.length;a++)if(t[a]===e)return a;return-1},useOneChip(t){if(this.gameData.usedChip<this.gameData.chip){this.gameData.usedChip++;let e=this.arrayElemIdx(this.unusedChips,t);this.unusedChips.splice(e,1);for(let t=0;t<this.usedChips.length;t++)if(-1===this.arrayElemIdx(this.usedChips,t))return void this.usedChips.push(t);this.usedChips.push(this.usedChips.length)}},resetOneChip(t){if(this.unusedChip<this.gameData.chip){this.gameData.usedChip--;let e=this.arrayElemIdx(this.usedChips,t);this.usedChips.splice(e,1);for(let t=0;t<this.unusedChips.length;t++)if(-1===this.arrayElemIdx(this.unusedChips,t))return void this.unusedChips.push(t);this.unusedChips.push(this.unusedChips.length)}},waitPlayer(){this.$refs.pregame.waitDuoPlayer()},enterRoom(){this.$refs.pregame.enterDuoRoom()},createWebSocket(){let t="ws://"+this.$store.state.backURL.split("http://")[1]+"/ws/game/"+this.gameUrl+"/gaming?login-token="+localStorage.token;try{this.wsObj=new WebSocket(t),this.initWSEventHandle()}catch(e){this.$message.error("连接失败，刷新试试。")}},initWSEventHandle(){this.wsObj.onopen=t=>{this.$message({type:"success",message:"服务器连接成功"})},this.wsObj.onmessage=t=>{-1===this.gameData.roleFlag&&(this.$refs.pregame.state=-1);let e=JSON.parse(t.data);switch(e.opt){case 1:this.gameData.deltaChip=e.data.chip-this.gameData.chip,this.gameData.chip=e.data.chip,this.gameData.prevUsed=this.gameData.usedChip,this.gameData.usedChip=0,this.gameData.roleFlag=e.data.roleFlag,this.gameData.gameOver=e.data.gameOver,this.gameData.prevOpponentUsedChip=e.data.prevOpponentUsedChip,2===this.state?this.state=3:0===this.state&&this.nextRound();break;case 2:this.$message.info("对手已经离开了。"),this.wsObj.close(),this.gameData.gameOver||(Object.assign(this.$data,this.$options.data()),Object.assign(this.$refs.pregame.$data,this.$refs.pregame.$options.data()));break;case 3:this.gameData.opponent=e.opponent;break}},this.wsObj.onclose=t=>{this.$message({type:"info",message:"已与服务器断开连接。"})}},sendData(){this.state=2,1===this.gameData.roleFlag?this.wsObj.send(JSON.stringify({usedChip:this.gameData.usedChip,oddOrEven:this.gameData.oddOrEven})):this.wsObj.send(this.gameData.usedChip)},gaming(){this.createWebSocket()},changeOddOrEven(){this.gameData.oddOrEven=0===this.gameData.oddOrEven?1:0},nextRound(){this.gameData.round++,this.state=this.gameData.gameOver?4:1,this.usedChips=[],this.unusedChips=[];for(let t=0;t<this.unusedChip;t++)setTimeout((()=>{this.unusedChips.push(t)}),100*t);this.gameData.gameOver&&this.$message.info("游戏结束，即将与服务器断开连接。")},getOpponentGuess(){return this.gameData.deltaChip>0&&this.gameData.usedChip%2===0?"单":"双"}},computed:{unusedChip(){return this.gameData.chip-this.gameData.usedChip},oddOrEvenStr(){return 0===this.gameData.oddOrEven?"双":"单"},isBtnDisabled(){return 1===this.gameData.roleFlag&&0===this.gameData.usedChip},oddEvenStyle(){return this.gameData.roleFlag>-1?"display: flex; justify-content: center":"display: flex; align-items: center; justify-content: center"}},beforeCreate(){this.$store.state.currentGameTitle="猜单双"},beforeDestroy(){null!=this.wsObj&&this.wsObj.close(),3===this.$refs.pregame.state&&this.$axios.get(this.$store.state.backURL+"/game/"+this.gameUrl+"/stop_waiting").then((t=>{200===t.data.code&&this.$message.info("房间已关闭。")}))}},I=T,N=(0,l.Z)(I,E,j,!1,null,"8bb75be4",null),z=N.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"phone_not_allowed"},[a("div",{attrs:{id:"phone_not_allowed_content"}},[a("h1",{attrs:{id:"notice"}},[t._v(t._s(this.$route.params.errorMsg))]),a("span",{attrs:{id:"comment1"}},[t._v("wjn真帅")])])])},A=[],Z={mounted(){null!=this.$route.params.errorMsg&&""!==this.$route.params.errorMsg||this.$router.replace("/home")}},G=Z,H=(0,l.Z)(G,B,A,!1,null,null,null),K=H.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"chat_room"}},[t._m(0),a("div",{attrs:{id:"record_container"}},[a("div",{staticStyle:{display:"inline-block",width:"60%"},attrs:{id:"record_area"}},t._l(t.records,(function(e,s){return a("div",{key:s,staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{color:"deepskyblue","margin-right":"20px"}},[t._v(t._s(e.username))]),a("span",{staticStyle:{color:"gray"}},[t._v(t._s(e.createTime))]),a("br"),a("span",{staticStyle:{width:"100%","font-size":"20px","word-wrap":"break-word","word-break":"break-all"},domProps:{innerHTML:t._s(e.content)}})])})),0),a("div",{attrs:{id:"users_container"}},[a("h3",[t._v("在线用户列表")]),a("div",{staticStyle:{overflow:"auto"}},t._l(t.onlineUsers,(function(e,s){return a("p",{key:s},[t._v(t._s(e))])})),0)])]),a("div",{attrs:{id:"send_container"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.toSend,expression:"toSend"}],attrs:{id:"input_area",disabled:t.inputDisabled,placeholder:t.inputPlaceholder,maxlength:"500"},domProps:{value:t.toSend},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:t.keyCtrlEnter.apply(null,arguments):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.keyEnter.apply(null,arguments)}],input:function(e){e.target.composing||(t.toSend=e.target.value)}}}),a("el-button",{style:t.btnStyle,attrs:{id:"btn_send",disabled:t.isBtnDisabled,type:"success"},on:{click:t.send}},[t._v("发送消息 ")])],1)])},J=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"reminder_container"}},[a("p",[t._v("聊天室只会展示近3天的记录（除非你不退出）")])])}],q={name:"ChatRoomView",data(){return{wsObj:null,toSend:"",records:[],isAltEnter:!1,onlineUsers:[],inputPlaceholder:"请输入内容（enter发送，ctrl+enter换行）",inputDisabled:!1}},methods:{createWebSocket(){let t="ws://"+this.$store.state.backURL.split("http://")[1]+"/ws/game/chat_room/chatting?login-token="+localStorage.token;try{this.wsObj=new WebSocket(t),this.initWSEventHandle()}catch(e){this.$message.error("连接失败，刷新试试。")}},initWSEventHandle(){this.wsObj.onopen=t=>{console.log(t),this.$message({type:"success",message:"与聊天室成功连接。"})},this.wsObj.onmessage=t=>{let e=JSON.parse(t.data);switch(e.opt){case 1:for(let t in e.onlineUsers)this.onlineUsers=e.onlineUsers;break;case 2:e.message.content=e.message.content.replace(/\n/g,"<br/>"),this.records.push(e.message),setTimeout((()=>{this.scrollToBottom()}),1)}},this.wsObj.onclose=t=>{this.$message.info("已与聊天室断开连接。"),this.inputDisabled=!0,this.inputPlaceholder="离线状态，请刷新。",this.onlineUsers=[]}},send(){this.wsObj.send(this.toSend),this.toSend="",this.$("#input_area").focus()},scrollToBottom(){let t=document.getElementById("record_area");t.scrollTop=t.scrollHeight+1e3},keyCtrlEnter(t){let e=this.$("#input_area")[0],a=e.selectionStart;e.value=e.value.substr(0,a)+content+e.value.substr(a)},keyEnter(t){t.preventDefault(),this.isBtnDisabled||this.send()}},computed:{btnStyle(){return this.isBtnDisabled?"cursor: not-allowed":"cursor: pointer"},isBtnDisabled(){return""===this.toSend||null==this.toSend}},beforeCreate(){this.$store.state.currentGameTitle="聊天室"},mounted(){this.$axios.get(this.$store.state.backURL+"/chat_room/get_history").then((t=>{if(200===t.data.code){let e=t.data.historyRecords;for(let t=0;t<e.length;t++)e[t].content=e[t].content.replace(/\n/g,"<br/>");this.records=e,setTimeout((()=>{this.scrollToBottom()}),1)}else this.$message.error("获取历史聊天记录失败，刷新试试。")})),this.createWebSocket()},beforeDestroy(){null!=this.wsObj&&this.wsObj.close()}},Q=q,X=(0,l.Z)(Q,V,J,!1,null,"5ee78af8",null),Y=X.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"gobang"},[a("PregameComponent",{ref:"pregame"}),t.gameData.roleFlag>-1?a("div",{attrs:{id:"game_body"}},[a("div",{staticClass:"content_center"},[a("h1",[t._v("对手："),a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.gameData.opponent))]),a("span",{staticStyle:{"margin-left":"30px"}},[t._v("我方："),0===t.gameData.roleFlag?a("span",{staticStyle:{"border-radius":"10px",padding:"5px"}},[t._v("黑")]):a("span",{staticStyle:{color:"white","-webkit-text-stroke":"1px black","border-radius":"10px",padding:"5px"}},[t._v("白")])])])]),a("canvas",{attrs:{id:"board"}}),a("div",{staticClass:"content_center",staticStyle:{overflow:"hidden"}},[a("transition",{attrs:{"enter-active-class":"animate__animated animate__backInRight","leave-active-class":"animate__animated animate__backOutLeft"}},[1===t.noticeState?a("h1",{key:"1",staticStyle:{color:"#67C23A"}},[t._v(" 轮到我方落子。 ")]):t._e(),2===t.noticeState?a("h1",{key:"2"},[t._v(" 等待对方落子... ")]):a("h1",{key:"3"},[t._v("游戏结束。"),t.gameData.winner!==t.gameData.roleFlag?a("span",{staticStyle:{color:"#F56C6C"}},[t._v("你输了。")]):a("span",{staticStyle:{color:"#67C23A"}},[t._v("你赢了。")])])])],1)]):t._e()],1)},et=[],at={components:{PregameComponent:R},data(){return{gameUrl:"gobang",ctx:null,cellWidth:40,r:10,wsObj:null,uploading:!1,gameData:{opponent:"",gomoku:null,roleFlag:-1,turn:-1,winner:-1},playerNum:1,totalPlayerNum:2}},methods:{drawBoard(){let t=this.$("#board")[0];this.ctx=t.getContext("2d"),t.width=t.height=16*this.cellWidth,this.ctx.strokeStyle="#000000";for(let e=0;e<15;e++)this.ctx.beginPath(),this.ctx.moveTo((e+1)*this.cellWidth,this.cellWidth),this.ctx.lineTo((e+1)*this.cellWidth,15*this.cellWidth),this.ctx.stroke();for(let e=0;e<15;e++)this.ctx.beginPath(),this.ctx.moveTo(this.cellWidth,(e+1)*this.cellWidth),this.ctx.lineTo(15*this.cellWidth,(e+1)*this.cellWidth),this.ctx.stroke()},handleClick(t){if(console.log(this.gameData.winner),-1!==this.gameData.winner)return void this.$message.warning("游戏已经结束了。");if(this.uploading)return void this.$message.warning("落子已提交，等待服务器响应。");if(this.gameData.roleFlag!==this.gameData.turn)return void this.$message.warning("对手的回合，请等待对手下棋。");let e=t.offsetX-this.cellWidth,a=t.offsetY-this.cellWidth,s=this.close(e,0,14),i=this.close(a,0,14),r=[],n=Math.abs(e-s[0]*this.cellWidth)<Math.abs(e-s[1]*this.cellWidth)?Math.abs(e-s[0]*this.cellWidth)<this.r?s[0]*this.cellWidth:void 0:Math.abs(e-s[1]*this.cellWidth)<this.r?s[1]*this.cellWidth:void 0,o=Math.abs(a-i[0]*this.cellWidth)<Math.abs(a-i[1]*this.cellWidth)?Math.abs(a-i[0]*this.cellWidth)<this.r?i[0]*this.cellWidth:void 0:Math.abs(a-i[1]*this.cellWidth)<this.r?i[1]*this.cellWidth:void 0;void 0!==n&&void 0!==o&&(r=[n,o]),0!==r.length&&this.setNode(r)},close(t,e,a){t=t<0?0:t,t=t>14*this.cellWidth?14*this.cellWidth:t;let s=a-e;if(1===s)return[e,a];if(t<(e+Math.ceil(s/2))*this.cellWidth){let a=e,i=e+Math.ceil(s/2);return this.close(t,a,i)}{let i=e+Math.ceil(s/2),r=a;return this.close(t,i,r)}},setNode(t){void 0===this.gameData.gomoku[t[0]/this.cellWidth][t[1]/this.cellWidth]&&this.gameData.roleFlag===this.gameData.turn&&this.wsObj.send(t[0]/this.cellWidth+","+t[1]/this.cellWidth)},enterRoom(){this.$refs.pregame.enterDuoRoom()},waitPlayer(){this.$refs.pregame.waitDuoPlayer()},createWebSocket(){let t="ws://"+this.$store.state.backURL.split("http://")[1]+"/ws/game/"+this.gameUrl+"/gaming?login-token="+localStorage.token;try{this.wsObj=new WebSocket(t),this.initWSEventHandle()}catch(e){this.$message.error("连接失败，刷新试试。")}},initWSEventHandle(){this.wsObj.onopen=t=>{this.$message({type:"success",message:"服务器连接成功"})},this.wsObj.onmessage=t=>{-1===this.gameData.roleFlag&&(this.$refs.pregame.state=-1);let e=JSON.parse(t.data);switch(e.opt){case 1:this.uploading=!1;let t=e.data.newPiece,a=[parseInt(t.split(",")[0])*this.cellWidth,parseInt(t.split(",")[1])*this.cellWidth];this.gameData.roleFlag=e.data.roleFlag,0===this.gameData.turn?(this.ctx.fillStyle="black",this.ctx.beginPath(),this.ctx.arc(a[0]+this.cellWidth,a[1]+this.cellWidth,this.r,0,2*Math.PI),this.ctx.stroke(),this.ctx.fill(),this.gameData.gomoku[a[0]/this.cellWidth][a[1]/this.cellWidth]=this.roleFlag,this.roleFlag=1):(this.ctx.fillStyle="white",this.ctx.beginPath(),this.ctx.arc(a[0]+this.cellWidth,a[1]+this.cellWidth,this.r,0,2*Math.PI),this.ctx.stroke(),this.ctx.fill(),this.gameData.gomoku[a[0]/this.cellWidth][a[1]/this.cellWidth]=this.roleFlag,this.roleFlag=0),this.gameData.turn=e.data.turn,-1!==e.data.winner&&(this.gameData.winner=e.data.winner,this.$message.info("游戏结束，即将与服务器断开连接。"));break;case 2:this.$message.info("对手已经离开了。"),this.wsObj.close(),-1===this.gameData.winner&&(Object.assign(this.$data,this.$options.data()),Object.assign(this.$refs.pregame.$data,this.$refs.pregame.$options.data()));break;case 3:this.gameData.opponent=e.opponent,this.gameData.roleFlag=e.data.roleFlag,this.gameData.turn=e.data.turn,setTimeout((()=>{this.drawBoard();let t=this.$("#board")[0];t.addEventListener("click",this.handleClick),this.gameData.gomoku=new Array(15);for(let e=0;e<this.gameData.gomoku.length;e++)this.gameData.gomoku[e]=new Array(15)}),1);break}},this.wsObj.onclose=t=>{this.$message({type:"info",message:"已与服务器断开连接。"})}},gaming(){this.createWebSocket()}},computed:{noticeState(){return-1!==this.gameData.winner?3:this.gameData.turn!==this.gameData.roleFlag?2:1}},beforeCreate(){this.$store.state.currentGameTitle="五子棋"},beforeDestroy(){null!=this.wsObj&&this.wsObj.close(),3===this.$refs.pregame.state&&this.$axios.get(this.$store.state.backURL+"/game/"+this.gameUrl+"/stop_waiting").then((t=>{200===t.data.code&&this.$message.info("房间已关闭。")}))}},st=at,it=(0,l.Z)(st,tt,et,!1,null,"bdf0adde",null),rt=it.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"p414"},[a("div",{attrs:{id:"game_body"}},[a("el-row",{staticStyle:{height:"75%"}},[a("el-col",{staticClass:"content_center",staticStyle:{height:"100%"},attrs:{span:4}},[a("el-col",{staticStyle:{display:"block"}},[a("el-row",{staticClass:"username"},[t._v("MRL")]),a("el-row",[a("el-button",{staticStyle:{padding:"5px","font-size":"30px"},attrs:{round:"",disabled:""}},[t._v("10")])],1)],1),a("el-row",[a("el-button",{staticClass:"card",staticStyle:{margin:"0",color:"black"},attrs:{disabled:""}},[a("span",{staticStyle:{color:"black",filter:"grayscale(100%)"}},[t._v("🤡")]),a("br"),a("span",{staticStyle:{"font-size":"20px"}})])],1)],1),a("el-col",{staticStyle:{height:"100%"},attrs:{span:16}},[a("el-row",{staticClass:"username"},[t._v("MRL")]),a("el-row",[a("el-button",{staticStyle:{padding:"5px","font-size":"30px"},attrs:{round:"",disabled:""}},[t._v("10")])],1),a("el-row",[a("el-button",{staticClass:"card",staticStyle:{margin:"0",color:"black"},attrs:{disabled:""}},[a("span",[t._v("A")]),a("br"),a("span",{staticStyle:{"font-size":"20px"}},[t._v("♦")])])],1),a("el-row",{staticStyle:{"margin-top":"200px"}},[a("el-button",{staticClass:"card",staticStyle:{margin:"0",color:"black"},attrs:{disabled:""}},[a("span",[t._v("A")]),a("br"),a("span",{staticStyle:{"font-size":"20px"}},[t._v("♠️")])])],1)],1),a("el-col",{staticClass:"content_center",staticStyle:{height:"100%"},attrs:{span:4}},[a("el-row",[a("el-button",{staticClass:"card",staticStyle:{margin:"0",color:"black"},attrs:{disabled:""}},[a("span",[t._v("A")]),a("br"),a("span",{staticStyle:{"font-size":"20px"}},[t._v("♦")])])],1),a("el-col",{staticStyle:{display:"block"}},[a("el-row",{staticClass:"username"},[t._v("MRL")]),a("el-row",[a("el-button",{staticStyle:{padding:"5px","font-size":"30px"},attrs:{round:"",disabled:""}},[t._v("10")])],1)],1)],1)],1),a("el-row",{staticStyle:{height:"5%",padding:"0"}},[a("el-button",{attrs:{type:"warning"}},[t._v("单挑")]),a("el-button",{attrs:{type:"primary"}},[t._v("钩岔")]),a("el-button",{attrs:{type:"info"}},[t._v("跳过")]),a("el-button",{attrs:{type:"success"}},[t._v("出牌")])],1),a("el-row",{staticClass:"content_center",staticStyle:{height:"20%","margin-left":"-60px"}},t._l([1,2,3,4,5,6,7,8,9,10,"J","Q","K"],(function(e,s){return a("el-button",{key:s,staticClass:"card",style:"z-index: "+s,attrs:{id:"holding"+s},on:{click:function(e){return t.toggleMoveUpCard(s)}}},[a("span",[t._v(t._s(e))]),a("br"),a("span",{staticStyle:{"font-size":"20px"}},[t._v("♠")])])})),1)],1)])},ot=[],lt=(a(6699),{data(){return{gameData:{opponents:[],holding:[],status:0,turn:0,chosen:[],last:[],opposite:[],next:[],playerNum:1,totalPlayerNum:4}}},methods:{toggleMoveUpCard(t){null==this.chosen&&(this.chosen=[]);let e=document.getElementById("holding"+t);this.chosen.includes(t)?(this.chosen=this.chosen.filter((e=>e!==t)),e.classList.remove("move-up")):(this.chosen.push(t),e.classList.add("move-up"))},waitPlayer(){}},beforeCreate(){this.$store.state.currentGameTitle="414"}}),ct=lt,ht=(0,l.Z)(ct,nt,ot,!1,null,"69141994",null),dt=ht.exports;s["default"].use(d.Z);const mt=[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:f,meta:{notNeedLogin:!0}},{path:"/login",name:"login",component:x,meta:{notNeedLogin:!0}},{path:"/game",name:"game",component:W,children:[{path:"odd_even",name:"odd_even",component:z},{path:"gobang",name:"gobang",component:rt},{path:"chat_room",name:"chat_room",component:Y},{path:"p414",name:"p414",component:dt}]},{path:"/error",name:"error",component:K,meta:{notNeedLogin:!0}}],pt=new d.Z({mode:"hash",base:"",routes:mt});pt.beforeEach((function(t,e,a){t.meta.notNeedLogin||localStorage.getItem("token")?a():a({name:"login",params:{notice:!0}})}));var gt=pt,ut=a(5173);s["default"].use(ut.ZP);var vt=new ut.ZP.Store({state:{currentGameTitle:"",backURL:"http://localhost:6660",serverErrMsg:"服务器有点问题，稍后再试试。"},getters:{},mutations:{},actions:{},modules:{}}),ft=a(6211),bt=a.n(ft),_t=a(1960),yt=a.n(_t),wt=a(3570),kt=a.n(wt);s["default"].use(yt()),bt().defaults.withCredentials=!0,s["default"].prototype.$axios=bt(),s["default"].prototype.$=kt(),s["default"].config.productionTip=!1,bt().interceptors.request.use((t=>{let e=localStorage.getItem("token");return e&&(t.headers["Authorization"]=e),t}),(t=>{Promise.reject(t)})),new s["default"]({router:gt,store:vt,render:t=>t(h)}).$mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,a),r.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,s,i,r){if(!s){var n=1/0;for(h=0;h<t.length;h++){s=t[h][0],i=t[h][1],r=t[h][2];for(var o=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(t){return a.O[t](s[l])}))?s.splice(l--,1):(o=!1,r<n&&(n=r));if(o){t.splice(h--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var h=t.length;h>0&&t[h-1][2]>r;h--)t[h]=t[h-1];t[h]=[s,i,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,r,n=s[0],o=s[1],l=s[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var h=l(a)}for(e&&e(s);c<n.length;c++)r=n[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(h)},s=self["webpackChunkmy_games_frontend"]=self["webpackChunkmy_games_frontend"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(9393)}));s=a.O(s)})();
//# sourceMappingURL=app.900b1dda.js.map